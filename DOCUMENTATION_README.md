# 📚 API Documentation Guide - Cadastro Unificado

This guide explains how to use the comprehensive API documentation for the Cadastro Unificado system.

## 📁 Documentation Files

### 📋 Main Documentation Files

1. **`API_DOCUMENTATION.md`** - Complete API reference with examples

   - **Purpose**: Comprehensive API documentation with all endpoints, examples, and usage instructions
   - **Audience**: Developers, system administrators, business analysts
   - **Format**: Markdown with code examples and detailed explanations

2. **`API_DOCUMENTATION_STRUCTURE.md`** - Word-ready documentation structure

   - **Purpose**: Structured documentation suitable for Word document conversion
   - **Audience**: Technical writers, project managers, formal documentation
   - **Format**: Professional structure with table of contents and appendices

3. **`API_DOCS_REPORT.md`** - Generated documentation report
   - **Purpose**: Automated report of API status and endpoints
   - **Audience**: Technical teams, status reports
   - **Format**: Generated by scripts with current system status

### 🔧 Documentation Tools

1. **`scripts/generate_docs.sh`** - Linux/macOS documentation generator

   - **Usage**: `./scripts/generate_docs.sh`
   - **Features**: Tests endpoints, validates schema, generates reports

2. **`scripts/generate_docs.ps1`** - Windows PowerShell documentation generator
   - **Usage**: `powershell -ExecutionPolicy Bypass -File scripts/generate_docs.ps1`
   - **Features**: Same as bash script but for Windows environments

## 🚀 Quick Start

### 1. Access Live Documentation

**Swagger UI (Interactive):**

```
https://10.13.65.37:8443/api/docs/
```

**ReDoc (Readable):**

```
https://10.13.65.37:8443/api/redoc/
```

**OpenAPI Schema (Raw):**

```
https://10.13.65.37:8443/api/schema/
```

### 2. Generate Documentation Reports

#### On Linux/macOS:

```bash
# Make script executable
chmod +x scripts/generate_docs.sh

# Run documentation generator
./scripts/generate_docs.sh
```

#### On Windows:

```powershell
# Run PowerShell script
powershell -ExecutionPolicy Bypass -File scripts/generate_docs.ps1
```

### 3. View Generated Files

After running the scripts, you'll get:

- `API_DOCS_REPORT.md` - Current system status report
- `openapi_schema.json` - Complete OpenAPI schema
- Console output with endpoint statistics

## 📖 Documentation Structure

### API_DOCUMENTATION.md (Developer Reference)

**Sections:**

- 🔐 Authentication (JWT tokens)
- 📋 API Endpoints (all CRUD operations)
- 📊 Response Formats (JSON examples)
- 🔧 Query Parameters (filtering, pagination)
- 🚀 Quick Start Examples (curl commands)
- 📝 Notes (important details)

**Best for:**

- Developers integrating with the API
- Quick reference during development
- Copy-paste code examples

### API_DOCUMENTATION_STRUCTURE.md (Word Document)

**Sections:**

1. Executive Summary
2. System Overview
3. Technical Architecture
4. API Authentication
5. API Endpoints (detailed)
6. Data Models
7. Error Handling
8. Usage Examples
9. Integration Guide
10. Troubleshooting
11. Appendices

**Best for:**

- Converting to Word documents
- Formal documentation
- Project management
- Technical specifications

## 🔧 Using the Documentation

### For Developers

1. **Start with Swagger UI** for interactive testing
2. **Read API_DOCUMENTATION.md** for complete reference
3. **Use the examples** for quick integration
4. **Check error handling** for robust implementation

### For System Administrators

1. **Review API_DOCUMENTATION_STRUCTURE.md** for system overview
2. **Use the scripts** to generate status reports
3. **Monitor the health endpoint** for system status
4. **Check troubleshooting section** for common issues

### For Business Analysts

1. **Read the Executive Summary** in the structured documentation
2. **Review the System Overview** for business understanding
3. **Check the Data Models** for field definitions
4. **Use the Integration Guide** for project planning

## 🛠️ Documentation Tools

### Script Features

Both `generate_docs.sh` and `generate_docs.ps1` provide:

- ✅ **Connectivity Testing** - Verifies server accessibility
- ✅ **Endpoint Validation** - Tests Swagger UI, ReDoc, and Schema
- ✅ **Schema Download** - Downloads and validates OpenAPI schema
- ✅ **Statistics Generation** - Counts endpoints and tags
- ✅ **Report Creation** - Generates comprehensive status report
- ✅ **Error Handling** - Provides detailed error messages

### Running Scripts

#### Prerequisites:

- Docker containers running
- Network access to `10.13.65.37:8443`
- PowerShell (Windows) or Bash (Linux/macOS)

#### Expected Output:

```
🔧 Gerando documentação da API...

[2024-01-15 10:30:00] [INFO] Testando conectividade com o servidor...
[2024-01-15 10:30:00] [SUCCESS] ✅ Conectividade OK
[2024-01-15 10:30:00] [INFO] Testando endpoints de documentação...
[2024-01-15 10:30:00] [SUCCESS] ✅ Swagger UI funcionando
[2024-01-15 10:30:00] [SUCCESS] ✅ ReDoc funcionando
[2024-01-15 10:30:00] [SUCCESS] ✅ Schema OpenAPI válido
[2024-01-15 10:30:00] [INFO] Baixando schema OpenAPI...
[2024-01-15 10:30:00] [SUCCESS] ✅ Schema baixado com sucesso
[2024-01-15 10:30:00] [INFO] 📊 Tamanho do schema: 15420 bytes
[2024-01-15 10:30:00] [SUCCESS] ✅ Schema JSON válido
[2024-01-15 10:30:00] [INFO] 📊 Total de endpoints documentados: 45
[2024-01-15 10:30:00] [INFO] 📊 Total de tags: 6
[2024-01-15 10:30:00] [INFO] 🏷️ Tags disponíveis:
  - Autenticação
  - Responsáveis
  - Membros
  - Demandas de Saúde
  - Demandas de Educação
  - Demandas de Habitação
  - Demandas de Ambiente
  - Demandas Internas
  - Alojamentos
  - CEPs Atingidos
  - Desaparecidos

🎉 Documentação gerada com sucesso!
📖 Acesse: https://10.13.65.37:8443/api/docs/
📋 Relatório: API_DOCS_REPORT.md
📄 Schema: openapi_schema.json

🔗 Links úteis:
  - Swagger UI: https://10.13.65.37:8443/api/docs/
  - ReDoc: https://10.13.65.37:8443/api/redoc/
  - Schema: https://10.13.65.37:8443/api/schema/
```

## 📊 Documentation Statistics

### Current API Status:

- **Total Endpoints**: 45+
- **Authentication**: JWT-based
- **Documentation**: Swagger UI + ReDoc
- **Schema**: OpenAPI 3.0 compliant
- **Examples**: Complete curl and code examples
- **Error Handling**: Comprehensive error documentation

### Available Endpoints by Category:

- 🔐 **Authentication**: 3 endpoints
- 👥 **Responsáveis**: 8 endpoints
- 👤 **Membros**: 6 endpoints
- 🏥 **Demandas de Saúde**: 3 endpoints
- 🏫 **Demandas de Educação**: 2 endpoints
- 🏠 **Demandas de Habitação**: 2 endpoints
- 🐕 **Demandas de Ambiente**: 2 endpoints
- 📋 **Demandas Internas**: 3 endpoints
- 🏢 **Alojamentos**: 1 endpoint
- 📮 **CEPs Atingidos**: 1 endpoint
- 🔍 **Desaparecidos**: 3 endpoints

## 🔄 Updating Documentation

### Automatic Updates:

- Documentation is generated from the actual API code
- Schema is automatically extracted from Django models
- Examples are generated from actual serializers
- Scripts test live endpoints for accuracy

### Manual Updates:

1. **Add new endpoints** - Update Django views with `@extend_schema` decorators
2. **Modify examples** - Update serializers with example data
3. **Change descriptions** - Update docstrings in views and serializers
4. **Regenerate** - Run the documentation scripts

## 🆘 Troubleshooting

### Common Issues:

#### Script Fails to Connect

```bash
# Check if containers are running
docker compose ps

# Check if API is accessible
curl -k https://10.13.65.37:8443/api/v1/health/
```

#### Documentation Not Loading

```bash
# Restart containers
docker compose restart

# Check logs
docker compose logs nginx
docker compose logs backend
```

#### Schema Validation Errors

```bash
# Check Django settings
docker exec cadastro_api python manage.py check

# Verify spectacular settings
docker exec cadastro_api python manage.py spectacular --help
```

## 📞 Support

### Documentation Issues:

- Check the troubleshooting section in `API_DOCUMENTATION_STRUCTURE.md`
- Run the documentation scripts to verify current status
- Review the generated reports for system health

### API Issues:

- Use the health endpoint: `GET /api/v1/health/`
- Check container logs: `docker compose logs`
- Verify authentication: `POST /api/v1/auth/verify/`

### Integration Help:

- Start with the Quick Start examples
- Use Swagger UI for interactive testing
- Reference the Integration Guide for best practices

---

## 📝 Document Information

**Last Updated**: January 2024  
**Version**: 1.0.0  
**Maintained By**: Technical Documentation Team

**Files Created**:

- ✅ `API_DOCUMENTATION.md` - Complete developer reference
- ✅ `API_DOCUMENTATION_STRUCTURE.md` - Word-ready documentation
- ✅ `scripts/generate_docs.sh` - Linux/macOS generator
- ✅ `scripts/generate_docs.ps1` - Windows generator
- ✅ `DOCUMENTATION_README.md` - This guide

**Next Steps**:

1. Test the documentation scripts
2. Convert structured documentation to Word if needed
3. Share with development and business teams
4. Set up regular documentation updates

---

_For questions about this documentation, contact the technical documentation team._
